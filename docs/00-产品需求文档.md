# 梦见小程序 PRD v2.0

## 一、产品概述

### 1.1 产品定位

一款结合 AI 梦境解析与 gamification 机制的每日打卡类小程序，通过"记梦-解析-改运任务"的闭环，培养用户习惯并通过激励视频广告变现。

### 1.2 目标用户

- 核心用户：18-35 岁女性，对玄学/心理学有兴趣
- 次要用户：有解梦需求的泛用户群体

### 1.3 商业模式

- 激励视频广告（查看完整解析前必看）
- 小额会员（9.9 元/月解锁无广告+高级功能）
- Banner 广告（非核心流程）

### 1.4 产品介绍

每个梦都是心灵的私语。在这里，记录夜晚的奇遇，AI 为你温柔解读梦境密码。坚持记梦，遇见更懂自己的你。

---

## 二、功能模块

### 2.1 核心功能

#### 功能 1：梦境记录

**入口**：首页"记录今天的梦"按钮

**交互流程**：

1. 用户输入梦境描述（文字，50-3000 字）
2. 添加梦境标签（飞行/追逐/考试/亲人/水/动物/死亡等预设标签）
3. 选择情绪（开心/恐惧/困惑/悲伤/平静等）
4. 点击"开始解析"

**数据存储**：

- 梦境文本（originalContent 永久保存原始内容）
- 标签（tags）
- 情绪（mood）
- 记录时间
- 当前版本 ID（支持多版本）

#### 功能 2：AI 梦境解析

**触发条件**：用户提交梦境后

**交互流程**：

1. 显示"AI 解析中..."加载动画
2. 非 VIP 用户弹出激励视频广告（30 秒）
3. 观看完毕后展示解析结果

**解析内容结构**：

- **梦境主题**（theme）：1 句话概括
- **心理解读**（interpretation）：3-5 句话的专业分析
- **运势评分**（fortuneScore）：1-100 分
- **运势提示**（fortuneTips）：事业/感情/健康三个维度
- **改运任务**：1 个趣味任务

**技术方案**：

- 调用大模型 API（支持通义千问/文心一言等）
- Prompt 设计包含：周公解梦知识库 + 心理学常识 + 运势生成规则

#### 功能 3：梦境润色

**入口**：梦境详情页"润色"按钮

**功能说明**：

- AI 改写梦境内容，使表达更优美流畅
- 普通用户每日 3 次配额
- VIP 用户无限次数

**版本管理**：

- 创建梦境时自动生成 original 版本
- 润色后生成 polished 版本
- 支持切换查看不同版本
- 支持版本对比功能

#### 功能 4：改运任务打卡

**交互流程**：

1. 解析结果页显示今日任务
2. 用户完成后点击"已完成"
3. 获得"幸运值+10"（基础积分）
4. 可选：观看广告获得双倍奖励（+20）

**任务状态**：

- pending：待完成
- completed：已完成
- expired：已过期

#### 功能 5：探索广场

**入口**：底部导航"探索"

**功能说明**：

- 浏览其他用户公开的梦境
- 点赞功能（每用户对同一梦境只能点赞一次）
- 梦境浏览记录

**隐私控制**：

- 用户可选择是否公开梦境（isPublic）
- 公开梦境显示在探索广场

#### 功能 6：成就系统

**入口**：个人中心"成就"入口

**成就类型**：

- 连续记梦天数成就（consecutive_days）
- 累计记梦数量成就（total_dreams）
- 任务完成数量成就
- 探索互动成就

**奖励机制**：

- 解锁成就获得积分奖励
- 成就徽章展示

### 2.2 用户系统

#### 功能 7：用户登录

**登录方式**：

- 微信一键登录（小程序环境）
- JWT Token 认证

**用户数据**：

- isVip：会员状态
- luckyPoints：幸运值积分
- consecutiveDays：连续记梦天数
- lastDreamDate：最后记梦日期

#### 功能 8：VIP 会员

**会员权益**：

- 无广告查看解析结果
- 无限次梦境润色（普通用户 3 次/天）
- 解锁高级解析功能

**套餐设置**：

- 月度会员：9.9 元/月
- 季度会员（可选）
- 年度会员（可选）

### 2.3 辅助功能

#### 功能 9：梦境日历

**入口**：个人中心

**展示内容**：

- 日历视图，标记已记梦的日期
- 点击日期查看当日梦境列表
- 显示连续记梦天数统计

#### 功能 10：设置中心

**设置项**：

- 记梦提醒时间设置
- 隐私设置（默认公开/私密）
- 深色模式
- 关于页面
- 用户协议
- 隐私政策

---

## 三、页面结构

### 3.1 页面清单

| 页面     | 路径                    | 说明                     |
| -------- | ----------------------- | ------------------------ |
| 首页     | /pages/index            | 今日记梦入口、连续天数   |
| 记录     | /pages/record           | 输入梦境内容、标签、情绪 |
| 结果     | /pages/result           | AI 解析结果、改运任务    |
| 梦境详情 | /pages/dream-detail     | 查看历史梦境、润色入口   |
| 梦境列表 | /pages/dream-list       | 按日期查看梦境列表       |
| 版本对比 | /pages/dream-versions   | 对比原始/润色版本        |
| 个人中心 | /pages/profile          | 梦境日历、成就、统计     |
| 探索广场 | /pages/explore          | 浏览公开梦境、点赞       |
| 成就     | /pages/achievements     | 成就解锁进度、奖励       |
| 会员     | /pages/vip              | 会员套餐与权益           |
| 设置     | /pages/settings         | 应用设置                 |
| 关于     | /pages/about            | 关于我们                 |
| 用户协议 | /pages/agreement        | 用户服务协议             |
| 隐私政策 | /pages/privacy-policy   | 隐私保护政策             |
| 隐私设置 | /pages/privacy-settings | 隐私偏好设置             |

### 3.2 页面原型

#### 首页

```
┌─────────────────────┐
│   今天，你梦见了什么？   │
│                     │
│  [记录今天的梦] 按钮    │
│                     │
│  连续记梦：7天         │
│                     │
│  ─────────────────  │
│  昨日解析回顾          │
│  "你梦见了考试..."     │
│  [查看详情]           │
└─────────────────────┘
```

#### 解析结果页

```
┌─────────────────────┐
│  梦境解析             │
│                     │
│  主题：对未知的焦虑    │
│  心理解读：...        │
│                     │
│  今日运势 85分        │
│  事业：宜主动沟通      │
│  感情：保持耐心        │
│  健康：注意休息        │
│                     │
│  改运任务             │
│  今天喝咖啡时加糖      │
│  [已完成] [看广告翻倍] │
└─────────────────────┘
```

#### 个人中心

```
┌─────────────────────┐
│  梦境日历             │
│  [日历组件]           │
│                     │
│  我的成就             │
│  连续记梦7天 ✅       │
│  幸运值：120          │
│                     │
│  [开通会员]           │
│  [设置]              │
└─────────────────────┘
```

---

## 四、数据模型

### 4.1 核心模型

| 模型         | 说明          | 关键字段                                       |
| ------------ | ------------- | ---------------------------------------------- |
| User         | 用户          | isVip, luckyPoints, consecutiveDays            |
| Dream        | 梦境          | content, originalContent, tags, mood, isPublic |
| DreamVersion | 梦境版本      | type(original/polished), isCurrent             |
| Analysis     | 解析结果      | theme, interpretation, fortuneScore            |
| Task         | 改运任务      | status, rewardPoints, isDoubleReward           |
| Achievement  | 成就          | conditionType, conditionValue, rewardPoints    |
| PolishQuota  | 润色配额      | total, used, remaining                         |
| PointRecord  | 积分记录      | type, amount, description                      |
| ExploreView  | 探索浏览/点赞 | dreamId, userId, isLiked                       |

### 4.2 业务逻辑

**连续记梦天数计算**：

- 每次创建梦境时检查 lastDreamDate
- 距离上次正好 1 天：consecutiveDays += 1
- 超过 1 天：consecutiveDays = 1（重新开始）
- 同一天多次记录不影响连续天数

**积分系统**：

- 完成任务：+10 积分（可翻倍至 +20）
- 解锁成就：+奖励积分（由成就定义）
- 所有积分变动记录在 PointRecord 表

---

## 五、广告策略

### 5.1 广告位设置

| 位置       | 类型     | 时机             | 预估 eCPM |
| ---------- | -------- | ---------------- | --------- |
| 解析前     | 激励视频 | 非 VIP 必看      | ¥80-150   |
| 首页底部   | Banner   | 常驻             | ¥5-10     |
| 任务完成后 | 激励视频 | 可选（双倍奖励） | ¥80-150   |

### 5.2 VIP 免广告

- VIP 用户跳过解析前广告
- 直接查看解析结果

---

## 六、技术架构

### 6.1 技术栈

| 层级   | 技术选型                                    |
| ------ | ------------------------------------------- |
| 前端   | uni-app + Vue 3 + Vite + Pinia + TypeScript |
| 后端   | NestJS 10 + Prisma 5 + TypeScript           |
| 数据库 | MySQL 8 + Redis 7                           |
| AI     | 第三方大模型 API                            |
| 架构   | pnpm workspace monorepo                     |

### 6.2 API 响应格式

```json
{
    "code": 0,
    "message": "success",
    "data": {},
    "timestamp": 1704067200000,
    "requestId": "uuid"
}
```

### 6.3 成本估算（月活 1 万用户）

- 服务器：¥200/月
- AI API 调用：¥500/月（按 0.05 元/次，日均使用 1 次计算）
- 广告 SDK 接入：免费
- **总成本**：¥700/月

### 6.4 收入预估（月活 1 万用户）

- 广告收入：1 万人 × 30 天 × 2 次 × eCPM¥100/1000 = ¥60,000
- 会员收入：1 万人 × 2%转化 × ¥9.9 = ¥1,980
- **总收入**：¥61,980/月

---

## 七、数据指标

### 7.1 核心指标

- **次日留存**：目标 >40%
- **7 日留存**：目标 >25%
- **人均广告展示**：目标 2 次/日
- **广告完成率**：目标 >85%

### 7.2 辅助指标

- 平均梦境字数
- 任务完成率
- 润色功能使用率
- 探索广场互动率
- 分享率
- 付费转化率

---

## 八、风险与应对

### 8.1 核心风险

| 风险          | 影响         | 应对方案              |
| ------------- | ------------ | --------------------- |
| AI 解析质量差 | 用户流失     | 人工审核+优化 Prompt  |
| 广告完成率低  | 收入不达标   | 调整激励机制          |
| 留存率低      | 无法形成习惯 | 增加推送提醒+签到奖励 |

### 8.2 合规风险

- 避免使用"算命""预测"等敏感词
- 解析内容添加免责声明："本解析仅供娱乐参考"
- 不涉及付费占卜等需要资质的服务
- 用户隐私保护合规

---

## 九、版本规划

### v1.0 - MVP 版本（已完成）

- [x] 梦境记录（标签、情绪）
- [x] AI 梦境解析
- [x] 改运任务打卡
- [x] 梦境日历
- [x] 用户登录（微信）

### v1.1 - 增强版本（已完成）

- [x] 梦境润色功能
- [x] 梦境版本管理
- [x] 探索广场
- [x] 成就系统
- [x] VIP 会员系统
- [x] 深色模式
- [x] 隐私设置

### v2.0 - 规划中

- [ ] 梦境分享（生成图片）
- [ ] 梦境导出（PDF）
- [ ] 梦境搜索
- [ ] 梦境统计分析
- [ ] 社交互动增强
